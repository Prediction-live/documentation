Privy is used as the authentication provider. Then, there are two ways to enforce authorization.
The first option is to use the Privy ID token, and mint a new token from it using Supabase to create a Session. With that option, every request is proxied by the NextJS server. The server uses Supabase's`secret key` to bypass RLS and retrieve any data. Thus, the identity of the person requesting the data must be verified before doing some data query. The easiest way to do that is to get Privy ID Token, and verify it against Privy JWKS endpoint. It's easy to implement but a breach could lead to a disaster.
The second option is to exchange the Privy ID token against a Supabase ID Token, compatible with Supabase Auth. The big upside to that is that using the native Supabase Auth system makes it easy to use RLS down the road. It is more complex to implement but has massive security upsides.